---
name: jikime-migrate-to-nextjs
description: Legacy to Next.js 16 migration workflow specialist. Analyzes legacy projects (Vue, React CRA, Angular, Svelte) and orchestrates migration to modern Next.js 16 App Router architecture.
version: 1.0.0
tags: ["migration", "nextjs", "react", "vue", "angular", "svelte", "app-router"]
triggers:
  keywords: ["migrate", "migration", "nextjs", "vue-to-react", "angular-to-react", "마이그레이션"]
  phases: ["plan", "run"]
  agents: ["manager-strategy", "frontend"]
  languages: []
user-invocable: false
---

## Overview

This skill provides a comprehensive workflow for migrating legacy frontend projects to Next.js 16 with App Router.

## Target Stack

| Technology | Version | Purpose |
|------------|---------|---------|
| Framework | Next.js 16 | App Router architecture |
| Language | TypeScript 5.x | Type safety |
| Styling | Tailwind CSS 4.x | Utility-first CSS |
| UI Components | shadcn/ui | Accessible components |
| Icons | lucide-react | Icon library |
| State | Zustand | State management |

## Supported Source Frameworks

| Framework | Versions | Detection Pattern |
|-----------|----------|-------------------|
| Vue.js | 2.x, 3.x | `vue` in package.json, `.vue` files |
| React CRA | 16+, 17+, 18+ | `react-scripts` in package.json |
| React Vite | All | `@vitejs/plugin-react` in vite.config |
| Angular | 12+ ~ 17+ | `@angular/core` in package.json |
| Svelte | 3.x, 4.x | `svelte` in package.json |

---

## Migration Workflow

```
/jikime:migrate-1-analyze "./my-vue-app"
    │
    └─▶ ./migrations/my-vue-app/as_is_spec.md
                │
/jikime:migrate-2-plan my-vue-app
                │
                └─▶ ./migrations/my-vue-app/migration_plan.md
                            │
/jikime:migrate-2-plan --skill my-vue-app
                            │
                            └─▶ .claude/skills/my-vue-app/SKILL.md
                                        │
/jikime:migrate-3-execute my-vue-app [--output ./out]
                                        │
                                        └─▶ ./migrations/my-vue-app/out/ (migrated project)
                                            + ./migrations/my-vue-app/progress.yaml
```

---

## Configuration File Reference

The migration workflow uses `.migrate-config.yaml` to track artifact locations across commands.

### File Structure

```yaml
# .migrate-config.yaml (auto-generated by migrate-analyze)
version: "1.0"

projects:
  my-vue-app:
    source_path: ./my-vue-app
    artifacts_dir: ./migrations/my-vue-app
    target_framework: nextjs16
    created_at: "2026-01-20T15:30:00Z"
```

### Path Resolution Logic

All sub-commands (`plan`, `skill`, `run`) automatically resolve artifact paths:

```python
def get_artifacts_dir(project_name):
    """Resolve artifacts directory from config or use default."""
    config_path = ".migrate-config.yaml"

    if exists(config_path):
        config = load_yaml(config_path)
        if project_name in config.get("projects", {}):
            return config["projects"][project_name]["artifacts_dir"]

    # Fallback to default
    return f"./migrations/{project_name}"
```

### Override Behavior

| Priority | Source | Example |
|----------|--------|---------|
| 1 (highest) | `--artifacts-output` flag | Explicit user override |
| 2 | `.migrate-config.yaml` | Auto-resolved from config |
| 3 (lowest) | Default path | `./migrations/{project}/` |

---

## Framework Detection Algorithm

### Detection Priority

1. **package.json analysis** (primary)
2. **Configuration files** (secondary)
3. **File extension patterns** (tertiary)
4. **Import statement analysis** (quaternary)

### Detection Rules

```yaml
vue:
  package_json:
    - "vue": "*"
    - "@vue/cli-service": "*"
  config_files:
    - vue.config.js
    - vue.config.ts
    - vite.config.ts (with @vitejs/plugin-vue)
  file_patterns:
    - "**/*.vue"
  version_detection:
    vue2: '"vue": "^2.'
    vue3: '"vue": "^3.'

react_cra:
  package_json:
    - "react-scripts": "*"
  file_patterns:
    - src/index.js
    - src/index.tsx

react_vite:
  package_json:
    - "@vitejs/plugin-react": "*"
  config_files:
    - vite.config.js
    - vite.config.ts

angular:
  package_json:
    - "@angular/core": "*"
  config_files:
    - angular.json
  file_patterns:
    - "**/*.component.ts"
    - "**/*.module.ts"

svelte:
  package_json:
    - "svelte": "*"
  config_files:
    - svelte.config.js
  file_patterns:
    - "**/*.svelte"
```

---

## Component Mapping Strategy

### Vue → Next.js

| Vue Pattern | Next.js Equivalent |
|-------------|-------------------|
| `<template>` | JSX/TSX |
| `<script setup>` | Function component |
| `<style scoped>` | CSS Modules / Tailwind |
| `ref()`, `reactive()` | `useState` |
| `computed()` | `useMemo` |
| `watch()` | `useEffect` |
| `onMounted()` | `useEffect(() => {}, [])` |
| `v-if` / `v-else` | `{condition && ...}` |
| `v-for` | `.map()` |
| `v-model` | Controlled component |
| Vue Router | App Router |
| Vuex / Pinia | Zustand |

### React CRA → Next.js

| CRA Pattern | Next.js Equivalent |
|-------------|-------------------|
| `src/index.js` entry | `app/layout.tsx` |
| `react-router-dom` | App Router (file-based) |
| `BrowserRouter` | Remove (built-in) |
| `useNavigate()` | `useRouter()` from `next/navigation` |
| `<Link>` | `<Link>` from `next/link` |
| `process.env.REACT_APP_*` | `process.env.NEXT_PUBLIC_*` |

### Angular → Next.js

| Angular Pattern | Next.js Equivalent |
|-----------------|-------------------|
| `@Component` | Function component |
| `@Injectable` | Context / Custom hooks |
| `@NgModule` | Remove (not needed) |
| `*ngIf` | Conditional rendering |
| `*ngFor` | `.map()` |
| `[(ngModel)]` | Controlled component |
| Angular Router | App Router |
| RxJS | React Query / SWR |

### Svelte → Next.js

| Svelte Pattern | Next.js Equivalent |
|----------------|-------------------|
| `.svelte` files | `.tsx` files |
| `$:` reactive | `useMemo` / `useEffect` |
| `{#if}` / `{:else}` | Conditional rendering |
| `{#each}` | `.map()` |
| `bind:value` | Controlled component |
| Stores | Zustand |
| `onMount` | `useEffect` |
| `<slot>` | `children` prop |

---

## State Migration Decision Tree

```
Is the state...
│
├─ Global (app-wide)?
│   ├─ Complex with actions? → Zustand
│   ├─ Simple shared state? → React Context
│   └─ Server state? → React Query / SWR
│
├─ Component-local?
│   ├─ Primitive value? → useState
│   ├─ Object/Array? → useState with immutable updates
│   └─ Derived value? → useMemo
│
└─ Form state?
    ├─ Simple form? → useState + controlled
    └─ Complex form? → react-hook-form + zod
```

---

## Output Structure

All migration artifacts are stored under `{artifacts-dir}` (default: `./migrations/{project-name}/`):

```
./migrations/{project-name}/        # or custom --artifacts-output path
├── as_is_spec.md           # Phase 0: Current state analysis
├── migration_plan.md       # Phase 1: Migration strategy
├── component_mapping.yaml  # Component mapping table
├── SKILL.md                # Phase 2: Project-specific skill
└── progress.yaml           # Migration progress tracking
```

Migrated project structure:

```
{output-dir}/{project-name}/
├── src/
│   ├── app/
│   │   ├── layout.tsx
│   │   ├── page.tsx
│   │   └── {routes}/
│   ├── components/
│   │   ├── ui/           # shadcn components
│   │   └── {migrated}/   # migrated components
│   ├── lib/
│   │   └── utils.ts
│   └── stores/           # Zustand stores
├── public/
├── package.json
├── tailwind.config.ts
├── tsconfig.json
└── next.config.ts
```

---

## Agent Delegation Matrix

| Phase | Command | Primary Agent | Supporting |
|-------|---------|---------------|------------|
| 0 | migrate-analyze | Explore | frontend |
| 1 | migrate-2-plan | manager-spec | manager-strategy |
| 2 | migrate-2-plan --skill | skill-builder | frontend |
| 3 | migrate-3-execute | manager-ddd | frontend, test-guide |
| Full | friday | manager-migrate-nextjs | All above |

---

## Quality Gates

### Phase 1 (Plan)
- [ ] Strategy selected and justified
- [ ] Components prioritized
- [ ] Risks identified
- [ ] migration_plan.md generated

### Phase 2 (Skill)
- [ ] Component mappings defined
- [ ] Coding conventions established
- [ ] Project SKILL.md generated with reference skills
- [ ] Template: `@templates/project-skill-template.md`

### Phase 3 (Run)
- [ ] Next.js project created
- [ ] Components migrated
- [ ] TypeScript compiles
- [ ] Build successful

---

## Skill Reference System

`migrate-2-plan --skill` 명령어 실행 시 생성되는 프로젝트별 SKILL.md는 다음 스킬들을 자동 참조합니다.

### Core Reference Skills (Auto-linked)

| Skill | Purpose | Auto-Load Condition |
|-------|---------|---------------------|
| `jikime-nextjs@16` | Next.js 16 App Router 패턴 | 항상 |
| `jikime-nextjs@15` | Next.js 15 Breaking Changes | async params 감지 시 |
| `jikime-migration-patterns-auth` | 인증 마이그레이션 | 인증 코드 감지 시 |

### Conditional Reference Skills

| Skill | Trigger Condition |
|-------|-------------------|
| `jikime-platform-clerk` | Clerk import 감지 |
| `jikime-platform-supabase` | Supabase import 감지 |
| `jikime-library-vercel-ai-sdk` | AI SDK import 감지 |
| `jikime-library-shadcn` | shadcn/ui 사용 시 (기본) |

### Template Location

```
templates/project-skill-template.md  ← 프로젝트 SKILL.md 생성 템플릿
```

### How It Works

```
migrate-2-plan --skill my-app
    │
    ├─▶ 1. as_is_spec.md 분석
    │
    ├─▶ 2. 사용 기술 감지 (Auth, State, Styling)
    │
    ├─▶ 3. 관련 스킬 자동 매핑
    │       - jikime-nextjs@16 (필수)
    │       - jikime-migration-patterns-auth (조건부)
    │       - jikime-platform-* (조건부)
    │
    └─▶ 4. SKILL.md 생성 (Reference Skills 섹션 포함)
```

---

## Progressive Disclosure Modules

For detailed patterns, load on-demand:

### Tutorials & Quick Reference
- `@modules/project-initialization.md` - **프로젝트 초기화 완전 가이드** ⭐⭐ (NEW)
- `@modules/migration-flow-tutorial.md` - **실제 명령어 사용 흐름 튜토리얼** ⭐
- `@modules/cheatsheet.md` - **빠른 참조 가이드** ⭐
- `@modules/migration-scenario.md` - 완전한 마이그레이션 시나리오 (React → Next.js)

### Framework Patterns
- `@modules/vue-patterns.md` - Vue 2/3 → Next.js conversion rules
- `@modules/react-patterns.md` - React CRA/Vite → Next.js migration
- `@modules/nextjs16-patterns.md` - Next.js 16 App Router best practices

### Auth Migration
- `@jikime-migration-patterns-auth` - 인증 마이그레이션 종합 가이드
- `@jikime-nextjs@14`, `@jikime-nextjs@15`, `@jikime-nextjs@16` - 버전별 업그레이드

---

## Git Strategy

```yaml
branch_prefix: "migrate/"
commit_pattern: "migrate({scope}): {description}"
examples:
  - "migrate(analyze): complete AS_IS analysis for my-vue-app"
  - "migrate(Header): convert Header.vue to Header.tsx"
  - "migrate(routing): implement App Router navigation"
  - "migrate(complete): finish my-vue-app migration"
```

---

## Whitepaper Generation

### Overview

`migrate-analyze` 명령에 `--whitepaper` 플래그를 사용하면 클라이언트 제출용 전문 백서 패키지를 생성할 수 있습니다.

### Usage

```bash
# 전체 백서 패키지 생성 (기본 경로: ./whitepaper/)
/jikime:migrate-1-analyze "./my-vue-app" --whitepaper --client "ABC Corp" --target nextjs

# 영문 백서 생성
/jikime:migrate-1-analyze "./my-vue-app" --whitepaper --client "ABC Corp" --target nextjs --lang en

# 일본어 백서 생성
/jikime:migrate-1-analyze "./my-vue-app" --whitepaper --client "株式会社ABC" --target nextjs --lang ja

# 커스텀 출력 경로 지정
/jikime:migrate-1-analyze "./my-vue-app" --whitepaper --client "ABC Corp" --whitepaper-output ./docs/pre-migration

# 기본 분석만 실행 (백서 없음)
/jikime:migrate-1-analyze "./my-vue-app"
```

### Whitepaper Options

| Option | Default | Description |
|--------|---------|-------------|
| `--whitepaper` | - | 백서 생성 활성화 |
| `--whitepaper-output` | `./whitepaper/` | 백서 출력 디렉토리 |
| `--client` | "Client Company" | 클라이언트 회사명 (표지에 사용) |
| `--target` | - | 대상 프레임워크 힌트 (nextjs\|vite\|fastapi) |
| `--lang` | conversation_language | 백서 언어 (ko\|en\|ja\|zh) |

### Language Support

| Code | Language | Description |
|------|----------|-------------|
| `ko` | Korean | 한국어 백서 |
| `en` | English | English whitepaper |
| `ja` | Japanese | 日本語ホワイトペーパー |
| `zh` | Chinese | 中文白皮书 |

**Default**: `--lang` 미지정 시 사용자의 `conversation_language` 설정 사용

### Whitepaper Package Structure

**기본 출력 경로**: `{--whitepaper-output}` 또는 `./whitepaper/` (프로젝트 홈)

```
./whitepaper/                      # 백서 패키지 (--whitepaper 시)
    ├── 00_cover.md                # 표지 및 목차
    ├── 01_executive_summary.md    # 경영진 요약
    ├── 02_feasibility_report.md   # 타당성 보고서
    ├── 03_architecture_report.md  # 아키텍처 보고서
    ├── 04_complexity_matrix.md    # 복잡도 매트릭스
    ├── 05_migration_roadmap.md    # 마이그레이션 로드맵
    └── 06_baseline_report.md      # 보안/성능 기준선
```

### Document Descriptions

| Document | Purpose | Target Audience |
|----------|---------|-----------------|
| **Cover** | 표지, 목차, 기밀 고지 | 모든 독자 |
| **Executive Summary** | 핵심 요약, 권장 사항 | 경영진, 의사결정자 |
| **Feasibility Report** | 기술/경제적 타당성, 리스크 분석 | PM, Tech Lead |
| **Architecture Report** | AS-IS/TO-BE 아키텍처 비교 | 개발팀, 아키텍트 |
| **Complexity Matrix** | 컴포넌트별 복잡도, 공수 산정 | PM, Tech Lead |
| **Migration Roadmap** | 상세 일정, 마일스톤, 품질 게이트 | 전체 팀 |
| **Baseline Report** | 보안/성능 현황 및 목표 | 보안팀, DevOps |

### Agent Delegation for Whitepaper

| Document | Primary Agent | Supporting Agents |
|----------|---------------|-------------------|
| Executive Summary | manager-docs | manager-strategy |
| Feasibility Report | manager-strategy | frontend |
| Architecture Report | frontend | manager-strategy |
| Complexity Matrix | frontend | - |
| Migration Roadmap | manager-strategy | manager-spec |
| Baseline Report | security-auditor | optimizer |

### Quality Checklist

- [ ] 모든 7개 문서 생성 완료 (표지 + 6개 보고서)
- [ ] 클라이언트 이름이 표지에 표시됨
- [ ] 모든 Mermaid 다이어그램 정상 렌더링
- [ ] 공수 추정이 현실적이고 근거 있음
- [ ] 리스크에 대응하는 완화 전략 포함
- [ ] 경영진 요약은 비기술적 용어 사용
- [ ] 로드맵에 명확한 마일스톤 포함
- [ ] 플레이스홀더 텍스트 없음

### Templates

백서 문서 템플릿은 다음 위치에 있습니다:

```
.claude/skills/jikime-migrate-to-nextjs/templates/pre-migration/
├── 00_cover.md
├── 01_executive_summary.md
├── 02_feasibility_report.md
├── 03_architecture_report.md
├── 04_complexity_matrix.md
├── 05_migration_roadmap.md
└── 06_baseline_report.md
```

각 템플릿은 `{{PLACEHOLDER}}` 형식의 변수를 포함하며, 실제 분석 데이터로 대체됩니다.

---

## Post-Migration Whitepaper (완료 보고서)

### Overview

마이그레이션 완료 후 `--whitepaper-report` 플래그를 사용하면 Before/After 비교 기반의 완료 보고서를 생성합니다.

### Usage

```bash
# 마이그레이션 완료 후 결과 보고서 생성 (기본 경로: ./whitepaper-report/)
/jikime:migrate-3-execute my-vue-app --whitepaper-report --client "ABC Corp"

# 영문 완료 보고서 생성
/jikime:migrate-3-execute my-vue-app --whitepaper-report --client "ABC Corp" --lang en

# 일본어 완료 보고서 생성
/jikime:migrate-3-execute my-vue-app --whitepaper-report --client "株式会社ABC" --lang ja

# 커스텀 출력 경로 지정
/jikime:migrate-3-execute my-vue-app --whitepaper-report --client "ABC Corp" --whitepaper-output ./docs/post-migration
```

### Whitepaper Report Options

| Option | Default | Description |
|--------|---------|-------------|
| `--whitepaper-report` | - | 완료 보고서 생성 활성화 |
| `--whitepaper-output` | `./whitepaper-report/` | 완료 보고서 출력 디렉토리 |
| `--client` | "Client Company" | 클라이언트 회사명 (표지에 사용) |
| `--lang` | conversation_language | 보고서 언어 (ko\|en\|ja\|zh) |

### Language Support

| Code | Language | Description |
|------|----------|-------------|
| `ko` | Korean | 한국어 완료 보고서 |
| `en` | English | English completion report |
| `ja` | Japanese | 日本語完了レポート |
| `zh` | Chinese | 中文完成报告 |

**참고**: `--lang` 옵션을 지정하지 않으면 사용자의 `conversation_language` 설정을 따릅니다.

### Post-Migration Package Structure

**기본 출력 경로**: `{--whitepaper-output}` 또는 `./whitepaper-report/` (프로젝트 홈)

```
./whitepaper-report/                 # 완료 보고서 패키지 (--whitepaper-report 시)
├── 00_cover.md                      # 표지 및 핵심 성과 요약
├── 01_executive_summary.md          # 경영진 보고용 요약
├── 02_performance_comparison.md     # 성능 Before/After 비교
├── 03_security_improvement.md       # 보안 개선 사항
├── 04_code_quality_report.md        # 코드 품질 비교
├── 05_architecture_evolution.md     # 아키텍처 진화
├── 06_cost_benefit_analysis.md      # ROI 및 비용 효과 분석
└── 07_maintenance_guide.md          # 유지보수 가이드
```

### Document Descriptions

| Document | Purpose | Target Audience |
|----------|---------|-----------------|
| **Cover** | 핵심 성과 요약, Before/After 지표 | 모든 독자 |
| **Executive Summary** | 투자 정당성, ROI 요약 | 경영진, 의사결정자 |
| **Performance Comparison** | Core Web Vitals, 번들 크기 비교 | 기술팀, PM |
| **Security Improvement** | OWASP 대응, 취약점 해결 현황 | 보안팀, 컴플라이언스 |
| **Code Quality Report** | 타입 안전성, 테스트 커버리지 비교 | 개발팀, Tech Lead |
| **Architecture Evolution** | 기술 스택 변화, 구조 개선 | 아키텍트, 개발팀 |
| **Cost-Benefit Analysis** | 투자 회수 기간, 5년 ROI | 경영진, 재무팀 |
| **Maintenance Guide** | 개발 가이드, 운영 매뉴얼 | 개발팀, DevOps |

### Agent Delegation for Post-Migration Report

| Document | Primary Agent | Supporting Agents |
|----------|---------------|-------------------|
| Executive Summary | manager-docs | manager-strategy |
| Performance Comparison | optimizer | frontend |
| Security Improvement | security-auditor | - |
| Code Quality Report | manager-quality | refactorer |
| Architecture Evolution | frontend | manager-strategy |
| Cost-Benefit Analysis | manager-strategy | - |
| Maintenance Guide | manager-docs | devops |

### Quality Checklist (Post-Migration)

- [ ] 모든 8개 문서 생성 완료
- [ ] Before/After 지표가 정확하게 측정됨
- [ ] 성능 개선율이 실측 데이터 기반
- [ ] ROI 계산이 현실적이고 근거 있음
- [ ] 유지보수 가이드가 실행 가능함
- [ ] 플레이스홀더 텍스트 없음

### Templates

Post-Migration 문서 템플릿 위치:

```
.claude/skills/jikime-migrate-to-nextjs/templates/post-migration/
├── 00_cover.md
├── 01_executive_summary.md
├── 02_performance_comparison.md
├── 03_security_improvement.md
├── 04_code_quality_report.md
├── 05_architecture_evolution.md
├── 06_cost_benefit_analysis.md
└── 07_maintenance_guide.md
```

---

Version: 1.7.0
Last Updated: 2026-01-22
Changelog:
- v1.7.0: Added project-initialization.md with complete CLI setup guide (create-next-app, shadcn init, packages)
- v1.6.0: Added Skill Reference System - project SKILL.md now auto-references related skills
- v1.5.0: Added migration-flow-tutorial.md, cheatsheet.md with real command examples
- v1.4.0: Added --whitepaper-output and --lang options; Fixed whitepaper output path to project root (./whitepaper/, ./whitepaper-report/)
- v1.3.0: Reorganized templates into pre-migration/ and post-migration/ folders
- v1.2.0: Added Post-Migration Whitepaper with 8 document templates
- v1.1.0: Added Whitepaper Generation feature with 7 document templates
